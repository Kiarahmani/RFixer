(((a|b)(a*))(ba))*(((a|b)(a*))(b|ba))*
((a|b)a*ba)*(((a|b)a*b)?)
+++
aab
bba
ab
bab
baba
aaab
---
babab
babbb
bbbab
abbba
abbabbb
abbbbab
aabbab
bbbbbb
abab
abbab
bbaba
abbb
bbbabbab
abbaab
bbab
abbaba
