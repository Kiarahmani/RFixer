(((a|b)a*ba(a|b)|(a|b))(ba(a|b)|a)*ba|((a|b)a*ba))*(((a|b)a*ba(a|b)|(a|b))(ba(a|b)|a)*b|((a|b)a*b?))
((a|b)a*ba)*(((a|b)a*b)?)
+++
aab
bb
bab
baaab
ababb
bababb
ababab
baab
bba
bbabba
baba
aaaba
aaba
aba
---
a
ba
baa
aa
b
aaa
babaa
baaaa
bbaaa
aaabaa
bbaba
abab
bababa
abaa
aaaa
abaaaa
bbaa
abaabaa
